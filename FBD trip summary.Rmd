---
title: "Fiordland Bottlenose Dolphin Monitoring"
output: pdf_document
---

```{r setup, include=FALSE}

library(rgdal);library(dplyr);library(ggplot2)

path<-"//storage.hcs-p01.otago.ac.nz/sci-marine-mammal-backup/Fiordland Bottlenose dolphin/Long Term Monitoring/Doubtful Sound Dolphin Monitoring/"
year<-2021
YYYY_MM<-'2021_05'

fullpath<-paste0(path,year,"/",YYYY_MM,"/")

##Photo data##
data<-read.csv('./data/Doubtful2019_05.csv', header = T, stringsAsFactors = F)

##TRACKS##
track_files<-list.files(paste0(fullpath,'Tracks'), pattern = "*.gpx", full.names = T)
track_filenames<-list.files(paste0(fullpath,'Tracks'), pattern = "*.gpx", full.names = F)
track_filenames<-stringr::str_replace(track_filenames,'.gpx','')
tracks<-sapply(track_files, function (x) rgdal::readOGR(x,"tracks"))
names(tracks)<-track_filenames

tracks<-do.call(rbind, tracks)
dates<-substr(tracks$datestamp,1,10)
library(ggplot2)

NZ <- raster::getData(country="New Zealand", level=1)

effort_map<-ggplot()+
  geom_polygon(NZ, mapping = aes(long,lat,group = group))+
  geom_path(tracks, mapping = aes(long,lat,group = group, color = group))+
  coord_sf(xlim = c(166.8,167.2), ylim = c(-45.5,-45.15), crs = 4269)+
  theme_bw()+
  scale_color_viridis_d(name = "Date",labels = dates)

ggsave(filename = 'effort_map.png',effort_map,device = 'png', './figures', dpi = 320)# width = 169, height = 60, units = "mm", dpi = 320)
  
```

```{r effort_map, , echo=FALSE, warning=FALSE, message=FALSE,out.width="100%",fig.align='left'}
knitr::include_graphics("./figures/effort_map.png")
```


